{% load wagtailcore_tags wagtailimages_tags %}

{% image value.background_image original as bg_photo %}

<div class="csd-layout-3-col-section csd-section csd-bg-color-{{ value.background_color }} {{ value.css_classes }}"
     style="background-image: url('{{ bg_photo.url }}')"
>

  <div class="csd-container">

      {% for block in value.column_1 %}
      <div class="csd-cell csd-col-1 csd-row-{{ forloop.counter }}" style="grid-column: 1 / 1 ; grid-row: {{ forloop.counter }} / {{ forloop.counter }}">
        {% include_block block %}
      </div>
      {% endfor %}
      {% for block in value.column_2 %}
      <div class="csd-cell csd-col-2 csd-row-{{ forloop.counter }}" style="grid-column: 2 / 2 ; grid-row: {{ forloop.counter }} / {{ forloop.counter }}">
        {% include_block block %}
      </div>
      {% endfor %}
      {% for block in value.column_3 %}
      <div class="csd-cell csd-col-3 csd-row-{{ forloop.counter }}" style="grid-column: 3 / 3 ; grid-row: {{ forloop.counter }} / {{ forloop.counter }}">
        {% include_block block %}
      </div>
      {% endfor %}

  </div>
</div>

